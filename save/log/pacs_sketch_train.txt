Loading dataset...
GPU: 0
SaveName: pacs_sketch
SaveBestTest: False
SaveLater: False
Dataset: PACS
SourceDomain: ['art_painting', 'cartoon', 'photo']
TargetDomain: ['sketch']
KnownClasses: ['dog', 'elephant', 'giraffe', 'guitar', 'horse', 'house', 'person']
UnknownClasses: []
NumGroups: 7
BatchSize: 16
Algorithm: medic
TaskDomain: 3
TaskClass: 3
TasksPerStep: [3, 3, 3]
SelectionMode: random
CrossVal: True
Network: resnet50
NumEpoch: 6000
EvalStep: 300
OptimizeMethod: SGD
LearningRate: 0.0002
MetaLearningRate: 0.01
WithoutCloseSetClassifier: False
WithoutBinaryClassifier: False
ShareParameter: False
Loading models...
Start training...
Epoch: 300 Acc: 0.9582 (Val)
Epoch: 300 Loss: 0.0010 (Val)
Epoch: 300 Acc: 0.7343 (Test)
Current best val accuracy is 0.9582 (Test: [{'test_acc': '0.7343', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.7343 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Epoch: 600 Acc: 0.9631 (Val)
Epoch: 600 Loss: 0.0010 (Val)
Epoch: 600 Acc: 0.7773 (Test)
Current best val accuracy is 0.9631 (Test: [{'test_acc': '0.7773', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.7773 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Epoch: 900 Acc: 0.9606 (Val)
Epoch: 900 Loss: 0.0010 (Val)
Epoch: 900 Acc: 0.7783 (Test)
Current best val accuracy is 0.9631 (Test: [{'test_acc': '0.7773', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.7783 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Epoch: 1200 Acc: 0.9713 (Val)
Epoch: 1200 Loss: 0.0010 (Val)
Epoch: 1200 Acc: 0.7946 (Test)
Current best val accuracy is 0.9713 (Test: [{'test_acc': '0.7946', 'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
Current best test accuracy is 0.7946 ([{'oscr_c': '0.0000', 'oscr_b': '0.0000'}])
